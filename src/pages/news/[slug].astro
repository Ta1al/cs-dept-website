---
import Layout from '../../layouts/Layout.astro';
import Header from '../../components/layout/Header.astro';
import Footer from '../../components/layout/Footer.astro';
import { getCollection } from 'astro:content';
import '../../styles/global.css';

export async function getStaticPaths() {
  const news = await getCollection('news');
  return news.map((n) => ({ params: { slug: n.slug } }));
}

const { slug } = Astro.params;
const all = await getCollection('news');
const entry = all.find((n) => n.slug === slug);
if (!entry) {
  throw new Error('News not found');
}
const { Content } = await entry.render();
---

<Layout>
  <Header />
  <main class="pt-24 pb-16 px-5 max-w-4xl mx-auto">
    <a href="/news" class="text-sm text-blue-400 hover:text-blue-300">‚Üê Back to News</a>
    <h1 class="text-3xl md:text-4xl font-bold mt-2 bg-gradient-to-r from-blue-400 to-purple-600 bg-clip-text text-transparent">
      {entry.data.title}
    </h1>
    <div class="flex flex-wrap items-center gap-2 mt-2 text-xs">
      <span class="inline-flex items-center gap-1 px-2 py-1 rounded bg-blue-500/10 text-blue-300 border border-blue-500/30">
        <svg class="w-3.5 h-3.5" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/></svg>
        {new Date(entry.data.publishDate).toLocaleDateString()}
      </span>
      {entry.data.category && (
        <span class="inline-flex items-center gap-1 px-2 py-1 rounded bg-purple-500/10 text-purple-300 border border-purple-500/30">{entry.data.category}</span>
      )}
      {entry.data.author && (
        <span class="inline-flex items-center gap-1 px-2 py-1 rounded bg-gray-800 text-gray-300 border border-gray-700">
          <svg class="w-3.5 h-3.5" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.121 17.804A9 9 0 1112 21a9 9 0 01-6.879-3.196z"/></svg>
          {entry.data.author}
        </span>
      )}
    </div>

    {entry.data.description && (
      <p class="text-gray-400 mt-4">{entry.data.description}</p>
    )}

    <article class="news-article markdown-content mt-6">
      <Content />
    </article>
  </main>
  <Footer />
</Layout>

<style>
  .news-article {
    color: #d1d5db; /* text-gray-300 */
    line-height: 1.75;
  }
  .news-article h1,
  .news-article h2,
  .news-article h3,
  .news-article h4,
  .news-article h5,
  .news-article h6 {
    color: #fff;
    font-weight: 700;
    line-height: 1.25;
    margin-top: 1.25em;
    margin-bottom: 0.6em;
  }
  .news-article h2 { font-size: 1.5rem; }
  .news-article h3 { font-size: 1.25rem; }
  .news-article p { margin: 0.85em 0; }
  .news-article a { color: #60a5fa; text-decoration: underline; }
  .news-article a:hover { color: #93c5fd; }
  .news-article ul,
  .news-article ol { margin: 0.85em 0 0.85em 1.25em; }
  .news-article li { margin: 0.3em 0; }
  .news-article blockquote {
    margin: 1.25em 0;
    padding: 0.9em 1.1em;
    border-left: 3px solid rgba(59,130,246,0.5); /* blue-500 */
    background: rgba(17,24,39,0.6); /* gray-900/60 */
    color: #e5e7eb; /* text-gray-200 */
    border-radius: 0.5rem;
  }
  .news-article code {
    background: rgba(31,41,55,0.8); /* gray-800 */
    color: #fde68a; /* amber-200 */
    padding: 0.1em 0.35em;
    border-radius: 0.35rem;
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    font-size: 0.95em;
  }
  .news-article pre {
    background: #0b1220; /* deep dark */
    border: 1px solid #1f2937; /* gray-800 */
    padding: 1rem;
    border-radius: 0.75rem;
    overflow-x: auto;
    margin: 1.1em 0;
  }
  .news-article pre code { background: transparent; color: #e5e7eb; }
  .news-article img {
    display: block;
    margin: 1.25em auto;
    max-width: 100%;
    border-radius: 0.75rem;
    box-shadow: 0 10px 30px -15px rgba(0,0,0,0.6);
  }
  .news-article hr {
    border: 0;
    height: 1px;
    background: linear-gradient(to right, transparent, rgba(59,130,246,0.4), transparent);
    margin: 2rem 0;
  }
  .news-article table {
    width: 100%;
    border-collapse: collapse;
    margin: 1rem 0;
    border: 1px solid #1f2937; /* gray-800 */
  }
  .news-article th,
  .news-article td {
    border: 1px solid #1f2937;
    padding: 0.6rem 0.75rem;
  }
  .news-article thead th { background: rgba(31,41,55,0.7); color: #e5e7eb; }
</style>
