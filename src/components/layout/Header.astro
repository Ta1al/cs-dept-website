---
const currentPath = Astro.url.pathname;

// Helper function to check if current path matches nav item
const isActive = (path: string): boolean => {
  if (path === '/' && currentPath === '/') return true;
  if (path !== '/' && currentPath.startsWith(path)) return true;
  return false;
};
---

<header
  class="fixed top-0 left-0 right-0 z-50 bg-gray-900/80 backdrop-blur-md border-b border-gray-800"
>
  <nav class="container mx-auto px-6 py-4">
    <div class="flex items-center justify-between">
      <!-- Logo -->
      <div class="flex items-center space-x-3">
        <div
          class="w-10 h-10 rounded-lg flex items-center justify-center overflow-hidden"
        >
          <img
            src="/uos_footer_logo.jpg"
            alt="University of Sargodha Logo"
            class="w-full h-full object-contain"
          />
        </div>
        <div>
          <h1
            class="text-xl font-bold bg-gradient-to-r from-blue-400 to-purple-600 bg-clip-text text-transparent"
          >
            Computer Science
          </h1>
          <p class="text-sm text-gray-400">Department</p>
        </div>
      </div>

      <!-- Navigation -->
      <nav class="hidden lg:flex items-center space-x-6">
        <a
          href="/"
          class={`transition-colors duration-200 relative group ${
            isActive('/')
              ? 'text-blue-400'
              : 'text-gray-300 hover:text-blue-400'
          }`}
        >
          Home
          <span
            class={`absolute -bottom-1 left-0 h-0.5 bg-blue-400 transition-all duration-200 ${
              isActive('/') ? 'w-full' : 'w-0 group-hover:w-full'
            }`}></span>
        </a>
        <a
          href="/about"
          class={`transition-colors duration-200 relative group ${
            isActive('/about')
              ? 'text-blue-400'
              : 'text-gray-300 hover:text-blue-400'
          }`}
        >
          About
          <span
            class={`absolute -bottom-1 left-0 h-0.5 bg-blue-400 transition-all duration-200 ${
              isActive('/about') ? 'w-full' : 'w-0 group-hover:w-full'
            }`}></span>
        </a>
        <a
          href="/calendar"
          class={`transition-colors duration-200 relative group ${
            isActive('/calendar')
              ? 'text-blue-400'
              : 'text-gray-300 hover:text-blue-400'
          }`}
        >
          Calendar
          <span
            class={`absolute -bottom-1 left-0 h-0.5 bg-blue-400 transition-all duration-200 ${
              isActive('/calendar') ? 'w-full' : 'w-0 group-hover:w-full'
            }`}></span>
        </a>
        <a
          href="/admin/"
          class={`transition-colors duration-200 relative group ${
            currentPath.startsWith('/admin')
              ? 'text-blue-400'
              : 'text-gray-300 hover:text-blue-400'
          }`}
          rel="nofollow noopener"
        >
          Admin
          <span
            class={`absolute -bottom-1 left-0 h-0.5 bg-blue-400 transition-all duration-200 ${
              currentPath.startsWith('/admin') ? 'w-full' : 'w-0 group-hover:w-full'
            }`}></span>
        </a>
        <a
          href="/timetable"
          class={`transition-colors duration-200 relative group ${
            isActive('/timetable')
              ? 'text-blue-400'
              : 'text-gray-300 hover:text-blue-400'
          }`}
        >
          Timetable
          <span
            class={`absolute -bottom-1 left-0 h-0.5 bg-blue-400 transition-all duration-200 ${
              isActive('/timetable') ? 'w-full' : 'w-0 group-hover:w-full'
            }`}></span>
        </a>
        <!-- Tools Dropdown -->
        <div class="relative group">
          <button
            class={`px-4 py-2 rounded-lg transition-all duration-200 flex items-center ${
              isActive('/tools')
                ? 'text-blue-400'
                : 'text-gray-300 hover:text-blue-400'
            }`}
          >
            Tools
            <svg
              class="w-4 h-4 ml-2 transform group-hover:rotate-180 transition-transform duration-200"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M19 9l-7 7-7-7"></path>
            </svg>
          </button>
          <div
            class="absolute top-full right-0 mt-3 w-56 bg-gray-900/95 backdrop-blur-md border border-gray-700/50 rounded-xl shadow-2xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 transform translate-y-2 group-hover:translate-y-0 z-50 overflow-hidden"
          >
            <div class="p-2">
              <a
                href="/tools/cgpa-calculator"
                class={`block px-4 py-3 rounded-lg transition-all duration-200 hover:bg-gradient-to-r hover:from-blue-500/10 hover:to-purple-500/10 text-gray-300 hover:text-blue-400 border-l-2 border-transparent hover:border-blue-400 ${
                  currentPath === '/tools/cgpa-calculator'
                    ? 'text-blue-400 bg-gradient-to-r from-blue-500/10 to-purple-500/10 border-l-2 border-blue-400'
                    : ''
                }`}
              >
                <div class="font-medium">CGPA Calculator</div>
                <div class="text-xs text-gray-500 mt-1">Calculate your GPA</div>
              </a>
              <a
                href="/tools/room-finder"
                class={`block px-4 py-3 rounded-lg transition-all duration-200 hover:bg-gradient-to-r hover:from-blue-500/10 hover:to-purple-500/10 text-gray-300 hover:text-blue-400 border-l-2 border-transparent hover:border-blue-400 ${
                  currentPath === '/tools/room-finder'
                    ? 'text-blue-400 bg-gradient-to-r from-blue-500/10 to-purple-500/10 border-l-2 border-blue-400'
                    : ''
                }`}
              >
                <div class="font-medium">Room Finder</div>
                <div class="text-xs text-gray-500 mt-1">
                  Locate free classrooms
                </div>
              </a>
              <a
                href="/tools/study-resources"
                class={`block px-4 py-3 rounded-lg transition-all duration-200 hover:bg-gradient-to-r hover:from-blue-500/10 hover:to-purple-500/10 text-gray-300 hover:text-blue-400 border-l-2 border-transparent hover:border-blue-400 ${
                  currentPath === '/tools/study-resources'
                    ? 'text-blue-400 bg-gradient-to-r from-blue-500/10 to-purple-500/10 border-l-2 border-blue-400'
                    : ''
                }`}
              >
                <div class="font-medium">Study Resources</div>
                <div class="text-xs text-gray-500 mt-1">
                  Access study materials
                </div>
              </a>
            </div>
          </div>
        </div>

        <!-- Societies Dropdown -->
        <div class="relative group">
          <button
            class="bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 px-4 py-2 rounded-lg transition-all duration-200 transform hover:scale-105 flex items-center shadow-lg"
          >
            Societies
            <svg
              class="w-4 h-4 ml-2 transform group-hover:rotate-180 transition-transform duration-200"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M19 9l-7 7-7-7"></path>
            </svg>
          </button>
          <div
            class="absolute top-full right-0 mt-3 w-72 bg-gray-900/95 backdrop-blur-md border border-gray-700/50 rounded-xl shadow-2xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 transform translate-y-2 group-hover:translate-y-0 z-50 overflow-hidden"
          >
            <div class="p-2">
              <a
                href="/societies/ps"
                class={`block px-4 py-3 rounded-lg transition-all duration-200 hover:bg-gradient-to-r hover:from-blue-500/10 hover:to-purple-500/10 text-gray-300 hover:text-blue-400 border-l-2 border-transparent hover:border-blue-400 ${
                  currentPath === '/societies/ps'
                    ? 'text-blue-400 bg-gradient-to-r from-blue-500/10 to-purple-500/10 border-l-2 border-blue-400'
                    : ''
                }`}
              >
                <div class="font-medium">Programming Society</div>
                <div class="text-xs text-gray-500 mt-1">
                  Coding competitions & workshops
                </div>
              </a>
              <a
                href="/societies/cms"
                class={`block px-4 py-3 rounded-lg transition-all duration-200 hover:bg-gradient-to-r hover:from-blue-500/10 hover:to-purple-500/10 text-gray-300 hover:text-blue-400 border-l-2 border-transparent hover:border-blue-400 ${
                  currentPath === '/societies/cms'
                    ? 'text-blue-400 bg-gradient-to-r from-blue-500/10 to-purple-500/10 border-l-2 border-blue-400'
                    : ''
                }`}
              >
                <div class="font-medium">Computing Media Society</div>
                <div class="text-xs text-gray-500 mt-1">
                  Digital media & design
                </div>
              </a>
              <a
                href="/societies/egaming"
                class={`block px-4 py-3 rounded-lg transition-all duration-200 hover:bg-gradient-to-r hover:from-blue-500/10 hover:to-purple-500/10 text-gray-300 hover:text-blue-400 border-l-2 border-transparent hover:border-blue-400 ${
                  currentPath === '/societies/egaming'
                    ? 'text-blue-400 bg-gradient-to-r from-blue-500/10 to-purple-500/10 border-l-2 border-blue-400'
                    : ''
                }`}
              >
                <div class="font-medium">E-Gaming Society</div>
                <div class="text-xs text-gray-500 mt-1">
                  Gaming tournaments & events
                </div>
              </a>
              <a
                href="/societies/ems"
                class={`block px-4 py-3 rounded-lg transition-all duration-200 hover:bg-gradient-to-r hover:from-blue-500/10 hover:to-purple-500/10 text-gray-300 hover:text-blue-400 border-l-2 border-transparent hover:border-blue-400 ${
                  currentPath === '/societies/ems'
                    ? 'text-blue-400 bg-gradient-to-r from-blue-500/10 to-purple-500/10 border-l-2 border-blue-400'
                    : ''
                }`}
              >
                <div class="font-medium">Event Management Society</div>
                <div class="text-xs text-gray-500 mt-1">
                  Organizing department events
                </div>
              </a>
              <a
                href="/societies/pas"
                class={`block px-4 py-3 rounded-lg transition-all duration-200 hover:bg-gradient-to-r hover:from-blue-500/10 hover:to-purple-500/10 text-gray-300 hover:text-blue-400 border-l-2 border-transparent hover:border-blue-400 ${
                  currentPath === '/societies/pas'
                    ? 'text-blue-400 bg-gradient-to-r from-blue-500/10 to-purple-500/10 border-l-2 border-blue-400'
                    : ''
                }`}
              >
                <div class="font-medium">Performing Arts Society</div>
                <div class="text-xs text-gray-500 mt-1">
                  Drama, music & cultural events
                </div>
              </a>
              <a
                href="/societies/sports"
                class={`block px-4 py-3 rounded-lg transition-all duration-200 hover:bg-gradient-to-r hover:from-blue-500/10 hover:to-purple-500/10 text-gray-300 hover:text-blue-400 border-l-2 border-transparent hover:border-blue-400 ${
                  currentPath === '/societies/sports'
                    ? 'text-blue-400 bg-gradient-to-r from-blue-500/10 to-purple-500/10 border-l-2 border-blue-400'
                    : ''
                }`}
              >
                <div class="font-medium">Sports Society</div>
                <div class="text-xs text-gray-500 mt-1">
                  Athletic competitions & fitness
                </div>
              </a>
              <a
                href="/societies/blood-donation"
                class={`block px-4 py-3 rounded-lg transition-all duration-200 hover:bg-gradient-to-r hover:from-blue-500/10 hover:to-purple-500/10 text-gray-300 hover:text-blue-400 border-l-2 border-transparent hover:border-blue-400 ${
                  currentPath === '/societies/blood-donation'
                    ? 'text-blue-400 bg-gradient-to-r from-blue-500/10 to-purple-500/10 border-l-2 border-blue-400'
                    : ''
                }`}
              >
                <div class="font-medium">Blood Donation & Welfare Society</div>
                <div class="text-xs text-gray-500 mt-1">
                  Community service & welfare
                </div>
              </a>
            </div>
          </div>
        </div>
      </nav>

      <!-- Mobile menu button -->
      <button
        id="mobile-menu-btn"
        class="lg:hidden text-gray-300 hover:text-blue-400 transition-colors duration-200"
      >
        <svg
          class="w-6 h-6"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>
    </div>

    <!-- Mobile Navigation Menu -->
    <div
      id="mobile-menu"
      class="lg:hidden hidden bg-gray-900/95 backdrop-blur-md border-t border-gray-800"
    >
      <div class="px-6 py-4 space-y-4">
        <a
          href="/"
          class={`block transition-colors duration-200 ${
            isActive('/')
              ? 'text-blue-400'
              : 'text-gray-300 hover:text-blue-400'
          }`}>Home</a
        >
        <a
          href="/about"
          class={`block transition-colors duration-200 ${
            isActive('/about')
              ? 'text-blue-400'
              : 'text-gray-300 hover:text-blue-400'
          }`}>About</a
        >
        <a
          href="/calendar"
          class={`block transition-colors duration-200 ${
            isActive('/calendar')
              ? 'text-blue-400'
              : 'text-gray-300 hover:text-blue-400'
          }`}>Calendar</a
        >
        <a
          href="/admin/"
          class={`block transition-colors duration-200 ${
            currentPath.startsWith('/admin')
              ? 'text-blue-400'
              : 'text-gray-300 hover:text-blue-400'
          }`}
          rel="nofollow noopener"
        >Admin</a>
        <a
          href="/timetable"
          class={`block transition-colors duration-200 ${
            isActive('/timetable')
              ? 'text-blue-400'
              : 'text-gray-300 hover:text-blue-400'
          }`}>Timetable</a
        >

        <!-- Tools Dropdown (Mobile) -->
        <div class="space-y-2">
          <button
            id="mobile-tools-toggle"
            class="block bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 px-4 py-2 rounded-lg transition-all duration-200 text-center w-full flex items-center justify-center shadow-lg"
          >
            Tools
            <svg
              id="mobile-tools-dropdown-arrow"
              class="w-4 h-4 ml-2 transform transition-transform duration-200"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M19 9l-7 7-7-7"></path>
            </svg>
          </button>
          <div
            id="mobile-tools-dropdown"
            class="ml-2 space-y-1 hidden bg-gray-800/50 rounded-lg p-2 backdrop-blur-sm"
          >
            <a
              href="/tools/cgpa-calculator"
              class={`block px-3 py-2 rounded-lg transition-all duration-200 text-gray-400 hover:text-blue-400 hover:bg-blue-500/10 border-l-2 border-transparent hover:border-blue-400 ${
                currentPath === '/tools/cgpa-calculator'
                  ? 'text-blue-400 bg-blue-500/10 border-l-2 border-blue-400'
                  : ''
              }`}
            >
              <div class="font-medium text-sm">CGPA Calculator</div>
            </a>
            <a
              href="/tools/room-finder"
              class={`block px-3 py-2 rounded-lg transition-all duration-200 text-gray-400 hover:text-blue-400 hover:bg-blue-500/10 border-l-2 border-transparent hover:border-blue-400 ${
                currentPath === '/tools/room-finder'
                  ? 'text-blue-400 bg-blue-500/10 border-l-2 border-blue-400'
                  : ''
              }`}
            >
              <div class="font-medium text-sm">Room Finder</div>
            </a>
            <a
              href="/tools/study-resources"
              class={`block px-3 py-2 rounded-lg transition-all duration-200 text-gray-400 hover:text-blue-400 hover:bg-blue-500/10 border-l-2 border-transparent hover:border-blue-400 ${
                currentPath === '/tools/study-resources'
                  ? 'text-blue-400 bg-blue-500/10 border-l-2 border-blue-400'
                  : ''
              }`}
            >
              <div class="font-medium text-sm">Study Resources</div>
            </a>
          </div>
        </div>

        <!-- Societies Dropdown -->
        <div class="space-y-2">
          <button
            id="mobile-societies-toggle"
            class="block bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 px-4 py-2 rounded-lg transition-all duration-200 text-center w-full flex items-center justify-center shadow-lg"
          >
            Societies
            <svg
              id="mobile-dropdown-arrow"
              class="w-4 h-4 ml-2 transform transition-transform duration-200"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M19 9l-7 7-7-7"></path>
            </svg>
          </button>
          <div
            id="mobile-societies-dropdown"
            class="ml-2 space-y-1 hidden bg-gray-800/50 rounded-lg p-2 backdrop-blur-sm"
          >
            <a
              href="/societies/ps"
              class={`block px-3 py-2 rounded-lg transition-all duration-200 text-gray-400 hover:text-blue-400 hover:bg-blue-500/10 border-l-2 border-transparent hover:border-blue-400 ${
                currentPath === '/societies/ps'
                  ? 'text-blue-400 bg-blue-500/10 border-l-2 border-blue-400'
                  : ''
              }`}
            >
              <div class="font-medium text-sm">Programming Society</div>
            </a>
            <a
              href="/societies/cms"
              class={`block px-3 py-2 rounded-lg transition-all duration-200 text-gray-400 hover:text-blue-400 hover:bg-blue-500/10 border-l-2 border-transparent hover:border-blue-400 ${
                currentPath === '/societies/cms'
                  ? 'text-blue-400 bg-blue-500/10 border-l-2 border-blue-400'
                  : ''
              }`}
            >
              <div class="font-medium text-sm">Computing Media Society</div>
            </a>
            <a
              href="/societies/egaming"
              class={`block px-3 py-2 rounded-lg transition-all duration-200 text-gray-400 hover:text-blue-400 hover:bg-blue-500/10 border-l-2 border-transparent hover:border-blue-400 ${
                currentPath === '/societies/egaming'
                  ? 'text-blue-400 bg-blue-500/10 border-l-2 border-blue-400'
                  : ''
              }`}
            >
              <div class="font-medium text-sm">E-Gaming Society</div>
            </a>
            <a
              href="/societies/ems"
              class={`block px-3 py-2 rounded-lg transition-all duration-200 text-gray-400 hover:text-blue-400 hover:bg-blue-500/10 border-l-2 border-transparent hover:border-blue-400 ${
                currentPath === '/societies/ems'
                  ? 'text-blue-400 bg-blue-500/10 border-l-2 border-blue-400'
                  : ''
              }`}
            >
              <div class="font-medium text-sm">Event Management Society</div>
            </a>
            <a
              href="/societies/pas"
              class={`block px-3 py-2 rounded-lg transition-all duration-200 text-gray-400 hover:text-blue-400 hover:bg-blue-500/10 border-l-2 border-transparent hover:border-blue-400 ${
                currentPath === '/societies/pas'
                  ? 'text-blue-400 bg-blue-500/10 border-l-2 border-blue-400'
                  : ''
              }`}
            >
              <div class="font-medium text-sm">Performing Arts Society</div>
            </a>
            <a
              href="/societies/sports"
              class={`block px-3 py-2 rounded-lg transition-all duration-200 text-gray-400 hover:text-blue-400 hover:bg-blue-500/10 border-l-2 border-transparent hover:border-blue-400 ${
                currentPath === '/societies/sports'
                  ? 'text-blue-400 bg-blue-500/10 border-l-2 border-blue-400'
                  : ''
              }`}
            >
              <div class="font-medium text-sm">Sports Society</div>
            </a>
            <a
              href="/societies/blood-donation"
              class={`block px-3 py-2 rounded-lg transition-all duration-200 text-gray-400 hover:text-blue-400 hover:bg-blue-500/10 border-l-2 border-transparent hover:border-blue-400 ${
                currentPath === '/societies/blood-donation'
                  ? 'text-blue-400 bg-blue-500/10 border-l-2 border-blue-400'
                  : ''
              }`}
            >
              <div class="font-medium text-sm">
                Blood Donation & Welfare Society
              </div>
            </a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const mobileMenuBtn = document.getElementById('mobile-menu-btn');
    const mobileMenu = document.getElementById('mobile-menu');

    mobileMenuBtn?.addEventListener('click', () => {
      mobileMenu?.classList.toggle('hidden');
    });

    // Handle mobile societies dropdown
    const mobileSocietiesToggle = document.getElementById(
      'mobile-societies-toggle'
    );
    const mobileSocietiesDropdown = document.getElementById(
      'mobile-societies-dropdown'
    );
    const mobileDropdownArrow = document.getElementById(
      'mobile-dropdown-arrow'
    );
    // Tools mobile dropdown elements
    const mobileToolsToggle = document.getElementById('mobile-tools-toggle');
    const mobileToolsDropdown = document.getElementById(
      'mobile-tools-dropdown'
    );
    const mobileToolsDropdownArrow = document.getElementById(
      'mobile-tools-dropdown-arrow'
    );

    mobileSocietiesToggle?.addEventListener('click', () => {
      mobileSocietiesDropdown?.classList.toggle('hidden');
      mobileDropdownArrow?.classList.toggle('rotate-180');
    });

    mobileToolsToggle?.addEventListener('click', () => {
      mobileToolsDropdown?.classList.toggle('hidden');
      mobileToolsDropdownArrow?.classList.toggle('rotate-180');
    });
  });
</script>
